!function(){"use strict";var e,t,r,n,i={170:function(e,t,r){const n="~";var i=r(520);const o={users:"++id",goals:"userId",journal:"++id, [userId+date]",meals:"++id, recordId, userId, product.id, recipe.id",recipes:"++id, userId, name, *products.id",products:"++id, userId, name, proteins, fats, carbohydrates, kcalories"};class u extends i.ZP{constructor(){super("db_test_3"),this.version(1).stores(o)}}const s=new u;function d(e){return e.trim().toLowerCase()}function c(e){return e.toISOString().slice(0,10)}function l(e,t){let r=e.clone();return void 0!==(null==t?void 0:t.offset)&&(r=r.offset(t.offset)),void 0!==(null==t?void 0:t.limit)&&(r=r.limit(t.limit)),Promise.all([e.count(),r.toArray()]).then((e=>{let[t,r]=e;return{total:t,items:r}}))}function a(e,t){let r=e.clone();return"desc"===(null==t?void 0:t.dir)&&(r=r.reverse()),r}var f=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function u(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,s)}d((n=n.apply(e,t||[])).next())}))};const v={"GET users/{userId}/journal":(e,t)=>f(void 0,void 0,void 0,(function*(){return yield s.journal.where("[userId+date]").equals([e,t]).first()})),"DELETE users/{userId}/journal":e=>f(void 0,void 0,void 0,(function*(){try{yield s.journal.where("userId").equals(e).delete(),yield s.meals.where("userId").equals(e).delete()}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}})),"GET journal/{recordId}/meals":(e,t)=>f(void 0,void 0,void 0,(function*(){const r=s.meals.where("recordId").equals(e);return yield l(a(r,t),t)})),"PUT meals/{meal}":e=>f(void 0,void 0,void 0,(function*(){const t=c(e.time),r=void 0===e.recordId?void 0:yield s.journal.get(e.recordId);let n=null==r?void 0:r.id;if(void 0!==r&&r.date===t||(n=yield s.journal.put({userId:e.userId,date:c(e.time)})),void 0!==n){const t=yield s.meals.put(Object.assign(Object.assign({},e),{recordId:n}));return Object.assign(Object.assign({},e),{id:t,recordId:n})}throw new i.ZP.NotFoundError})),"DELETE meals/{mealId}":e=>f(void 0,void 0,void 0,(function*(){return yield s.meals.delete(e)}))};var p=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function u(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,s)}d((n=n.apply(e,t||[])).next())}))};const y={"GET products/{productId}":e=>p(void 0,void 0,void 0,(function*(){return yield s.products.get(e)})),"PUT products/{product}":e=>p(void 0,void 0,void 0,(function*(){const t=yield s.products.put(e);return Object.assign(Object.assign({},e),{id:t})})),"GET users/{userId}/products":(e,t)=>p(void 0,void 0,void 0,(function*(){let r;if(r=void 0!==(null==t?void 0:t.sort)?s.products.orderBy(t.sort).filter((t=>t.userId===e)):s.products.where("userId").equals(e),void 0!==(null==t?void 0:t.id)&&(r=r.filter((e=>Array.isArray(t.id)?t.id.includes(e.id):t.id===e.id))),"string"==typeof(null==t?void 0:t.name)){const e=d(t.name);r=r.filter((t=>d(t.name).startsWith(e)))}return yield l(a(r,t),t)})),"DELETE products/{productId}":e=>p(void 0,void 0,void 0,(function*(){try{yield s.products.delete(e),yield s.recipes.where("products.id").equals(e).modify((t=>{t.products=t.products.map((t=>Object.assign(Object.assign({},t),{isArchived:t.id===e})))})),yield s.meals.where("product.id").equals(e).modify({isArchieved:!0})}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}}))};var h=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function u(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,s)}d((n=n.apply(e,t||[])).next())}))};const g={"GET recipes/{recipeId}":e=>h(void 0,void 0,void 0,(function*(){return yield s.recipes.get(e)})),"PUT recipes/{recipe}":e=>h(void 0,void 0,void 0,(function*(){const t=yield s.recipes.put(e);return Object.assign(Object.assign({},e),{id:t})})),"GET users/{userId}/recipes":(e,t)=>h(void 0,void 0,void 0,(function*(){let r;if(r=void 0!==(null==t?void 0:t.sort)?s.recipes.orderBy(t.sort).filter((t=>t.userId===e)):s.recipes.where("userId").equals(e),void 0!==(null==t?void 0:t.id)&&(r=r.filter((e=>Array.isArray(t.id)?null==t?void 0:t.id.includes(e.id):t.id===e.id))),void 0!==(null==t?void 0:t.products)){const e=t.products;r=r.filter((t=>t.products.some((t=>e.includes(t.id)))))}if("string"==typeof(null==t?void 0:t.name)){const e=d(t.name);r=r.filter((t=>d(t.name).startsWith(e)))}return yield l(a(r,t),t)})),"DELETE recipes/{recipeId}":e=>h(void 0,void 0,void 0,(function*(){try{yield s.recipes.delete(e),yield s.meals.where("product.id").equals(e).modify({isArchieved:!0})}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}}))};var m=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function u(e){try{d(n.next(e))}catch(e){o(e)}}function s(e){try{d(n.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,s)}d((n=n.apply(e,t||[])).next())}))};const b={"GET users/{userId}":e=>m(void 0,void 0,void 0,(function*(){return yield s.users.get(e)})),"PUT users/{user}":e=>m(void 0,void 0,void 0,(function*(){const t=yield s.users.put(e);return Object.assign(Object.assign({},e),{id:t})})),"DELETE users/{userId}":e=>m(void 0,void 0,void 0,(function*(){return yield s.users.delete(e)})),"GET users":()=>m(void 0,void 0,void 0,(function*(){return yield s.users.toArray()})),"GET users/{userId}/goals":e=>m(void 0,void 0,void 0,(function*(){return yield s.goals.get({userId:e})})),"PUT goals/{goals}":e=>m(void 0,void 0,void 0,(function*(){return yield s.goals.put(e),e}))},w=Object.assign(Object.assign(Object.assign(Object.assign({},b),v),g),y);var j;j=w,self.onmessage=e=>{const t=e.data;if(!(t instanceof Object)||"string"!=typeof(null==t?void 0:t.queryAction))return;const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return e.split(t)[0]}(t.queryAction);r in j?void 0!==(null==t?void 0:t.queryActionArguments)&&Promise.resolve().then((()=>j[r].apply(self,t.queryActionArguments))).then((e=>{!function(e,t){self.postMessage({queryActionListener:e,queryActionResult:t})}(t.queryAction,e)})).catch((e=>{throw e})):console.warn(`Unknown action: ${r}`)}}},o={};function u(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return i[e].call(r.exports,r,r.exports,u),r.exports}u.m=i,u.x=function(){var e=u.O(void 0,[216],(function(){return u(170)}));return e=u.O(e)},e=[],u.O=function(t,r,n,i){if(!r){var o=1/0;for(l=0;l<e.length;l++){r=e[l][0],n=e[l][1],i=e[l][2];for(var s=!0,d=0;d<r.length;d++)(!1&i||o>=i)&&Object.keys(u.O).every((function(e){return u.O[e](r[d])}))?r.splice(d--,1):(s=!1,i<o&&(o=i));if(s){e.splice(l--,1);var c=n();void 0!==c&&(t=c)}}return t}i=i||0;for(var l=e.length;l>0&&e[l-1][2]>i;l--)e[l]=e[l-1];e[l]=[r,n,i]},r=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},u.t=function(e,n){if(1&n&&(e=this(e)),8&n)return e;if("object"==typeof e&&e){if(4&n&&e.__esModule)return e;if(16&n&&"function"==typeof e.then)return e}var i=Object.create(null);u.r(i);var o={};t=t||[null,r({}),r([]),r(r)];for(var s=2&n&&e;"object"==typeof s&&!~t.indexOf(s);s=r(s))Object.getOwnPropertyNames(s).forEach((function(t){o[t]=function(){return e[t]}}));return o.default=function(){return e},u.d(i,o),i},u.d=function(e,t){for(var r in t)u.o(t,r)&&!u.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},u.f={},u.e=function(e){return Promise.all(Object.keys(u.f).reduce((function(t,r){return u.f[r](e,t),t}),[]))},u.u=function(e){return"vendors.fdd2bff462c8e4ad1422.js"},u.miniCssF=function(e){},u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.j=170,function(){var e;u.g.importScripts&&(e=u.g.location+"");var t=u.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=e}(),function(){var e={170:1};u.f.i=function(t,r){e[t]||importScripts(u.p+u.u(t))};var t=self.webpackChunkkcal_pwa=self.webpackChunkkcal_pwa||[],r=t.push.bind(t);t.push=function(t){var n=t[0],i=t[1],o=t[2];for(var s in i)u.o(i,s)&&(u.m[s]=i[s]);for(o&&o(u);n.length;)e[n.pop()]=1;r(t)}}(),n=u.x,u.x=function(){return u.e(216).then(n)};u.x()}();