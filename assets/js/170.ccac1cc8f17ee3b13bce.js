!function(){"use strict";var e,t,r,i,n={8170:function(e,t,r){var i=r(9520);const n={users:"++id",info:"userId",goals:"userId",journal:"++id, [userId+date]",meals:"++id, recordId, userId, *dishes.type, *dishes.target.id",recipes:"++id, userId, name, *products.id",products:"++id, userId, name, proteins, fats, carbs, energy"};class o extends i.ZP{constructor(){super("ma_poop_data"),this.version(1).stores(n)}}const s=new o;function u(e){return e.trim().toLowerCase()}var d=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function u(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}d((i=i.apply(e,t||[])).next())}))};const c={"GET users/{userId}/journal":(e,t)=>d(void 0,void 0,void 0,(function*(){return yield s.journal.where("[userId+date]").equals([e,t]).first()})),"DELETE users/{userId}/journal":e=>d(void 0,void 0,void 0,(function*(){try{yield s.journal.where("userId").equals(e).delete(),yield s.meals.where("userId").equals(e).delete()}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}})),"GET journal/{recordId}/meals":e=>d(void 0,void 0,void 0,(function*(){return yield s.meals.where("recordId").equals(e).toArray()})),"PUT meals/{meal}":e=>d(void 0,void 0,void 0,(function*(){const t=new Date;e.time&&(t.setHours(e.time.getHours()),t.setMinutes(e.time.getMinutes()));const r=function(e){const t=e.getFullYear(),r=e.getMonth()+1,i=e.getDate();return`${t}-${r<10?`0${r}`:r}-${i<10?`0${i}`:i}`}(t),n=yield s.journal.where({userId:e.userId,date:r}).first();let o=null==n?void 0:n.id;if(void 0===n&&(o=yield s.journal.put({userId:e.userId,date:r})),void 0!==o){const r=yield s.meals.put(Object.assign(Object.assign({},e),{recordId:o,time:t}));return Object.assign(Object.assign({},e),{id:r,recordId:o,time:t})}throw new i.ZP.NotFoundError})),"DELETE meals/{mealId}":e=>d(void 0,void 0,void 0,(function*(){return yield s.meals.delete(e)}))};function l(e,t){let r=e.clone();return void 0!==(null==t?void 0:t.offset)&&(r=r.offset(t.offset)),void 0!==(null==t?void 0:t.limit)&&(r=r.limit(t.limit)),Promise.all([e.count(),r.toArray()]).then((e=>{let[t,r]=e;return{total:t,items:r}}))}function a(e,t){let r=e.clone();return"desc"===(null==t?void 0:t.dir)&&(r=r.reverse()),r}var f=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function u(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}d((i=i.apply(e,t||[])).next())}))};const v={"GET products/{productId}":e=>f(void 0,void 0,void 0,(function*(){return yield s.products.get(e)})),"PUT products/{product}":e=>f(void 0,void 0,void 0,(function*(){const t=yield s.products.put(e);return Object.assign(Object.assign({},e),{id:t})})),"GET users/{userId}/products":(e,t)=>f(void 0,void 0,void 0,(function*(){let r;if(r=void 0!==(null==t?void 0:t.sort)?s.products.orderBy(t.sort).filter((t=>t.userId===e)):s.products.where("userId").equals(e),void 0!==(null==t?void 0:t.id)&&(r=r.filter((e=>Array.isArray(t.id)?t.id.includes(e.id):t.id===e.id))),"string"==typeof(null==t?void 0:t.name)){const e=u(t.name);r=r.filter((t=>u(t.name).includes(e)))}return yield l(a(r,t),t)})),"DELETE products/{productId}":e=>f(void 0,void 0,void 0,(function*(){try{yield s.products.delete(e),yield s.recipes.where("products.id").equals(e).modify((t=>{t.products=t.products.map((t=>Object.assign(Object.assign({},t),{isArchived:t.id===e})))})),yield s.meals.where({"dishes.type":"product","dishes.target.id":e}).modify(((t,r)=>{r.value=Object.assign(Object.assign({},t),{dishes:t.dishes.map((t=>"product"===t.type&&t.target.id===e?Object.assign(Object.assign({},t),{isArchieved:!0}):t))})}))}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}}))};var p=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function u(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}d((i=i.apply(e,t||[])).next())}))};const y={"GET recipes/{recipeId}":e=>p(void 0,void 0,void 0,(function*(){return yield s.recipes.get(e)})),"PUT recipes/{recipe}":e=>p(void 0,void 0,void 0,(function*(){const t=yield s.recipes.put(e);return Object.assign(Object.assign({},e),{id:t})})),"GET users/{userId}/recipes":(e,t)=>p(void 0,void 0,void 0,(function*(){let r;if(r=void 0!==(null==t?void 0:t.sort)?s.recipes.orderBy(t.sort).filter((t=>t.userId===e)):s.recipes.where("userId").equals(e),void 0!==(null==t?void 0:t.id)&&(r=r.filter((e=>Array.isArray(t.id)?null==t?void 0:t.id.includes(e.id):t.id===e.id))),void 0!==(null==t?void 0:t.products)){const e=t.products;r=r.filter((t=>t.products.some((t=>e.includes(t.id)))))}if("string"==typeof(null==t?void 0:t.name)){const e=u(t.name);r=r.filter((t=>u(t.name).includes(e)))}return yield l(a(r,t),t)})),"DELETE recipes/{recipeId}":e=>p(void 0,void 0,void 0,(function*(){try{yield s.recipes.delete(e),yield s.meals.where({"dishes.type":"recipe","dishes.target.id":e}).modify(((t,r)=>{r.value=Object.assign(Object.assign({},t),{dishes:t.dishes.map((t=>"recipe"===t.type&&t.target.id===e?Object.assign(Object.assign({},t),{isArchieved:!0}):t))})}))}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}}))};var h=function(e,t,r,i){return new(r||(r=Promise))((function(n,o){function s(e){try{d(i.next(e))}catch(e){o(e)}}function u(e){try{d(i.throw(e))}catch(e){o(e)}}function d(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,u)}d((i=i.apply(e,t||[])).next())}))};const g={"GET users/{userId}":e=>h(void 0,void 0,void 0,(function*(){return yield s.users.get(e)})),"PUT users/{user}":e=>h(void 0,void 0,void 0,(function*(){const t=yield s.users.put(e);return Object.assign(Object.assign({},e),{id:t})})),"DELETE users/{userId}":e=>h(void 0,void 0,void 0,(function*(){try{yield s.users.delete(e),yield s.journal.where("userId").equals(e).delete(),yield s.goals.where("userId").equals(e).delete(),yield s.info.where("userId").equals(e).delete(),yield s.products.where("userId").equals(e).delete(),yield s.recipes.where("userId").equals(e).delete(),yield s.meals.where("userId").equals(e).delete()}catch(e){if(!(e instanceof i.ZP.ModifyError))throw e}})),"GET users":()=>h(void 0,void 0,void 0,(function*(){return yield s.users.toArray()})),"GET users/{userId}/goals":e=>h(void 0,void 0,void 0,(function*(){return yield s.goals.get({userId:e})})),"PUT goals/{goals}":e=>h(void 0,void 0,void 0,(function*(){return yield s.goals.put(e),e})),"GET users/{userId}/info":e=>h(void 0,void 0,void 0,(function*(){return yield s.info.get({userId:e})})),"PUT info/{info}":e=>h(void 0,void 0,void 0,(function*(){return yield s.info.put(e),e}))},m=Object.assign(Object.assign(Object.assign(Object.assign({},g),c),y),v);var w;w=m,self.onmessage=e=>{const t=e.data;if(!(t instanceof Object)||"string"!=typeof(null==t?void 0:t.queryAction))return;const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"~";return e.split(t)[0]}(t.queryAction);r in w?void 0!==(null==t?void 0:t.queryActionArguments)&&Promise.resolve().then((()=>w[r].apply(self,t.queryActionArguments))).then((e=>{!function(e,t){self.postMessage({queryActionListener:e,queryActionResult:t})}(t.queryAction,e)})).catch((e=>{throw e})):console.warn(`Unknown action: ${r}`)}}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e].call(r.exports,r,r.exports,s),r.exports}s.m=n,s.x=function(){var e=s.O(void 0,[216],(function(){return s(8170)}));return e=s.O(e)},e=[],s.O=function(t,r,i,n){if(!r){var o=1/0;for(l=0;l<e.length;l++){r=e[l][0],i=e[l][1],n=e[l][2];for(var u=!0,d=0;d<r.length;d++)(!1&n||o>=n)&&Object.keys(s.O).every((function(e){return s.O[e](r[d])}))?r.splice(d--,1):(u=!1,n<o&&(o=n));if(u){e.splice(l--,1);var c=i();void 0!==c&&(t=c)}}return t}n=n||0;for(var l=e.length;l>0&&e[l-1][2]>n;l--)e[l]=e[l-1];e[l]=[r,i,n]},r=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},s.t=function(e,i){if(1&i&&(e=this(e)),8&i)return e;if("object"==typeof e&&e){if(4&i&&e.__esModule)return e;if(16&i&&"function"==typeof e.then)return e}var n=Object.create(null);s.r(n);var o={};t=t||[null,r({}),r([]),r(r)];for(var u=2&i&&e;"object"==typeof u&&!~t.indexOf(u);u=r(u))Object.getOwnPropertyNames(u).forEach((function(t){o[t]=function(){return e[t]}}));return o.default=function(){return e},s.d(n,o),n},s.d=function(e,t){for(var r in t)s.o(t,r)&&!s.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,r){return s.f[r](e,t),t}),[]))},s.u=function(e){return"assets/js/vendors.b68b0124633b5f4abf6d.js"},s.miniCssF=function(e){},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.j=170,function(){var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e+"../../"}(),function(){var e={170:1};s.f.i=function(t,r){e[t]||importScripts(s.p+s.u(t))};var t=self.webpackChunkkcal_pwa=self.webpackChunkkcal_pwa||[],r=t.push.bind(t);t.push=function(t){var i=t[0],n=t[1],o=t[2];for(var u in n)s.o(n,u)&&(s.m[u]=n[u]);for(o&&o(s);i.length;)e[i.pop()]=1;r(t)}}(),i=s.x,s.x=function(){return s.e(216).then(i)};s.x()}();